<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Product Pagination</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet">

    <style>
        body { background-color: #f8f9fb; color: #333; }
        table { background-color: #fff; border-radius: 8px; overflow: hidden; }
        th a { text-decoration: none; color: #555; font-weight: 600; }
        th.active { background-color: #e3f2fd !important; }
        .pagination .page-link { border-radius: 6px; margin: 0 3px; }
    </style>
</head>

<body class="container mt-4">

<!-- HEADER + SIZE SELECT -->
<div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">
        PRODUCT LIST
        <small class="text-muted">
            (sorted by <b th:text="${field}"></b> - <b th:text="${dir}"></b>)
        </small>
    </h3>

    <form method="get" th:action="@{/product/page}" class="d-flex align-items-center gap-2">
        <span class="fw-semibold">Số lượng hiển thị:</span>

        <input type="hidden" name="field" th:value="${field}">
        <input type="hidden" name="dir" th:value="${dir}">
        <input type="hidden" name="p" value="0">

        <select name="size" class="form-select form-select-sm w-auto"
                onchange="this.form.submit()">
            <option value="5"   th:selected="${size==5}">5</option>
            <option value="10"  th:selected="${size==10}">10</option>
            <option value="20"  th:selected="${size==20}">20</option>
            <option value="50"  th:selected="${size==50}">50</option>
            <option value="100" th:selected="${size==100}">100</option>
            <option value="-1"  th:selected="${size==-1}">All</option>
        </select>
    </form>

</div>

<!-- TABLE -->
<table class="table table-bordered table-hover">
    <thead class="table-primary">
    <tr>
        <th th:classappend="${field=='id'} ? 'active'">
            <a th:href="@{/product/page(p=${page.number},size=${size},
                     field='id',dir=${field=='id' and dir=='asc'?'desc':'asc'})}">
                ID
            </a>
        </th>

        <th th:classappend="${field=='name'} ? 'active'">
            <a th:href="@{/product/page(p=${page.number},size=${size},
                     field='name',dir=${field=='name' and dir=='asc'?'desc':'asc'})}">
                Name
            </a>
        </th>

        <th th:classappend="${field=='category'} ? 'active'">
            <a th:href="@{/product/page(p=${page.number},size=${size},
             field='category',dir=${field=='category' and dir=='asc'?'desc':'asc'})}">
                Category
            </a>
        </th>

        <th th:classappend="${field=='price'} ? 'active'">
            <a th:href="@{/product/page(p=${page.number},size=${size},
                     field='price',dir=${field=='price' and dir=='asc'?'desc':'asc'})}">
                Price
            </a>
        </th>

        <th th:classappend="${field=='createDate'} ? 'active'">
            <a th:href="@{/product/page(p=${page.number},size=${size},
                     field='createDate',dir=${field=='createDate' and dir=='asc'?'desc':'asc'})}">
                Date
            </a>
        </th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="item : ${page.content}">
        <td th:text="${item.id}"></td>
        <td th:text="${item.name}"></td>
        <td th:text="${item.category.name}"></td>
        <td th:text="${#numbers.formatDecimal(item.price,0,'COMMA',0,'POINT')} + ' ₫'"></td>
        <td th:text="${#dates.format(item.createDate,'dd/MM/yyyy')}"></td>
    </tr>
    </tbody>
</table>

<!-- PAGINATION (ẨN KHI ALL) -->
<nav th:if="${size != -1}">
    <ul class="pagination justify-content-center">

        <li class="page-item" th:classappend="${page.first}?'disabled'">
            <a class="page-link"
               th:href="@{/product/page(p=0,size=${size},field=${field},dir=${dir})}">
                First
            </a>
        </li>

        <li class="page-item" th:classappend="${page.first}?'disabled'">
            <a class="page-link"
               th:href="@{/product/page(p=${page.number-1},size=${size},
                        field=${field},dir=${dir})}">
                Previous
            </a>
        </li>

        <li class="page-item disabled">
            <span class="page-link">
                Page [[${page.number+1}]] / [[${page.totalPages}]]
            </span>
        </li>

        <li class="page-item" th:classappend="${page.last}?'disabled'">
            <a class="page-link"
               th:href="@{/product/page(p=${page.number+1},size=${size},
                        field=${field},dir=${dir})}">
                Next
            </a>
        </li>

        <li class="page-item" th:classappend="${page.last}?'disabled'">
            <a class="page-link"
               th:href="@{/product/page(p=${page.totalPages-1},size=${size},
                        field=${field},dir=${dir})}">
                Last
            </a>
        </li>
    </ul>
</nav>
<div class="mt-4">
    <ul class="list-group">
        <li class="list-group-item">
            <b>Số thực thể hiện tại:</b> [[${page.numberOfElements}]]
        </li>
        <li class="list-group-item">
            <b>Trang hiện tại:</b> [[${page.number + 1}]]
        </li>
        <li class="list-group-item">
            <b>Kích thước trang:</b> [[${page.size}]]
        </li>
        <li class="list-group-item">
            <b>Tổng số thực thể:</b> [[${page.totalElements}]]
        </li>
        <li class="list-group-item">
            <b>Tổng số trang:</b> [[${page.totalPages}]]
        </li>
    </ul>
</div>

</body>
</html>
